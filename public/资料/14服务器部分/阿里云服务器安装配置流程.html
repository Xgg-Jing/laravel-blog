<!DOCTYPE html>
<html class="theme theme-white">
<head>
<meta charset="utf-8">
<title>阿里云服务器安装配置流程</title>
<link href="https://www.zybuluo.com/static/assets/template-theme-white.css" rel="stylesheet" media="screen">
<style type="text/css">

#wmd-preview h1  {
    color: #0077bb; /* 将标题改为蓝色 */
}</style>
</head>
<body class="theme theme-white">
<div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><div class="md-section-divider"></div><div class="md-section-divider"></div><h1 data-anchor-id="8br1" id="阿里云服务器安装配置流程">阿里云服务器安装配置流程</h1><p data-anchor-id="6758"><code>服务器</code></p><hr><p data-anchor-id="rzy3">很多童鞋对如何构建一个服务器的整体流程不是特别清楚，这篇文章的目的就是从头到尾教你搭建一个阿里云服务器，并安装LNMP环境，而且设置了二级域名，可以在一台服务器上运行多个项目。</p><p data-anchor-id="3dd3">目录介绍</p><blockquote data-anchor-id="elyk" class="white-blockquote">
  <ul>
  <li>申请阿里云服务器</li>
  <li>安装LNMP环境</li>
  <li>安装其他常用扩展</li>
  <li>如何在本地连接阿里云服务器</li>
  </ul>
</blockquote><div class="md-section-divider"></div><h3 data-anchor-id="zvva" id="申请阿里云服务器">申请阿里云服务器</h3><ol data-anchor-id="am0h">
<li>登录阿里云官网（<a href="https://www.aliyun.com/" target="_blank">https://www.aliyun.com/</a>），申请账号密码</li>
<li>点击控制台》云服务器ECS 》 实例  》创建实例，创建一个服务器实例（就是你网站的运行环境） <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/153845083.png" alt="mark" title=""></li>
<li><p>按照包年包月或按流量付费，选择一种计费方式</p>

<blockquote class="white-blockquote">
  <p>建议：如果只是测试练习，建议按流量比较省钱，几块钱就能做个测试，不用时随时关掉，记得不用时，一定要释放实例，不然还会继续扣费 <br>
  <img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/154341675.png" alt="mark" title=""> <br>
  安全组设置（可后期设置，如果不设置可能会造成只有IP可以访问，域名访问不了的情况） <br>
  <img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/155321113.png" alt="mark" title=""> <br>
  镜像选ubuntu 16.04   64位 <br>
  <img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/154849043.png" alt="mark" title=""> <br>
  设置服务器账号（默认root）、密码 <br>
  <img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/155155891.png" alt="mark" title=""></p>
</blockquote>

<p>接下来充钱，下单就可以了。</p></li>
</ol><p data-anchor-id="wve3">4 .  此时点击云服务器ECS的实例菜单，可以看到刚才购买的服务器实例 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/155626698.png" alt="mark" title=""></p><div class="md-section-divider"></div><h3 data-anchor-id="luun" id="安装lnmp环境">安装LNMP环境</h3><ol data-anchor-id="4jey">
<li>需要一个终端工具链接阿里云服务器，mac系统直接使用自带的终端工具Terminal.app,window系统建议使用Putty或者xshell。</li>
<li>因为大家一般使用window系统的比较多，我就在window系统上演示putty连接阿里云服务器。 <br>


<blockquote class="white-blockquote">
  打开putty软件，在开始页面输入你刚申请的阿里云服务器的IP <br>
  <img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/160236097.png" alt="mark" title=""> <br>
  输入上一篇中你申请服务器时填的账号密码，跟平时登录QQ没啥本质区别 <br>
  <img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/160454285.png" alt="mark" title=""> <br>
  如图表示你登录成功了 <br>
  <img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/160810745.png" alt="mark" title=""></blockquote></li>
  </ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="mx12"><ol class="linenums"><li class="L0"><code><span class="pln">ubuntu</span><span class="pun">系统</span><span class="pln"> </span><span class="pun">查看已安装的包</span><span class="pln">   dpkg </span><span class="pun">-</span><span class="pln">l </span><span class="pun">|</span><span class="pln"> grep gcc</span></code></li></ol></pre><ol data-anchor-id="w19u">
<li>安装N（nginx）+M(mysql)+P(php)</li>
</ol><div class="md-section-divider"></div><h4 data-anchor-id="fctv" id="首先更新一下源仓库将你要安装的软件先放仓库一份">首先更新一下源仓库,将你要安装的软件先放仓库一份</h4><blockquote data-anchor-id="2g7s" class="white-blockquote">
  <p>apt-get update</p>
</blockquote><p data-anchor-id="teau"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/161210022.png" alt="mark" title=""></p><div class="md-section-divider"></div><h4 data-anchor-id="ic5i" id="安装nginx">安装nginx</h4><blockquote data-anchor-id="qccu" class="white-blockquote">
  <p>apt-get install nginx</p>
</blockquote><p data-anchor-id="1wo8">输入以上命令后会提示你是否确认安装，选Y即可</p><p data-anchor-id="us0l"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/161331395.png" alt="mark" title=""></p><p data-anchor-id="21ji">安装完成后，在浏览器里输入你服务器的IP地址，如果显示如下页面说明安装成功了。</p><p data-anchor-id="f154"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/161636247.png" alt="mark" title=""></p><p data-anchor-id="lg5e"><strong>接下来需要对nginx进行配置，也是本文的重点</strong></p><p data-anchor-id="ovry">nginx的安装目录在/etc/nginx文件夹下 <br>
切换到nginx目录</p><p data-anchor-id="aqdm"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/161910497.png" alt="mark" title=""></p><p data-anchor-id="vkrc">目录下有一个sites-available 文件夹，这个文件夹里存放的就是nginx的配置文件 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/162131033.png" alt="mark" title=""></p><p data-anchor-id="zg6i">进入后修改default文件</p><blockquote data-anchor-id="r0ge" class="white-blockquote">
  <p>vim default</p>
</blockquote><p data-anchor-id="wspw"><img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/162345014.png" alt="mark" title=""></p><p data-anchor-id="tyod"><strong>需要修改以下配置，做了两张图，第一张是原配置，第二张是我们修改后的配置，按实际情况修改就行，这里我只讲步骤不讲原理，哪个配置项不明白为什么需要这样修改，复制这项直接百度就出结果了。</strong> <br>
修改前的配置 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/163202949.png" alt="mark" title=""> <br>
修改后的配置 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20180312/083604056.png" alt="mark" title="点击查看大图"></p><blockquote data-anchor-id="p3ew" class="white-blockquote">
  <p>ubuntu 默认是php-fpm。 采用端口方式就需要配置一下。也就是如果采用php-cgi监听9000端口的方式，需要找到/etc/php/7.0/fpm/poll.d/www.conf文件 <br>
  <img src="http://on64ewxzt.bkt.clouddn.com/blog/20180416/112128196.png" alt="mark"></p>
</blockquote><p data-anchor-id="9z8x"><strong>修改完配置后，要使配置生效还需要做一下软链接并重启nginx使配置加载</strong></p><p data-anchor-id="xzr7">做软链接 <br>
进入 /etc/nginx/sites-enabled目录，如图 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170330/164604385.png" alt="mark"></p><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="w56j"><ol class="linenums"><li class="L0"><code><span class="pln">ln </span><span class="pun">-</span><span class="pln">s </span><span class="pun">../</span><span class="pln">sites</span><span class="pun">-</span><span class="pln">available</span><span class="pun">/</span><span class="kwd">default</span><span class="pln"> </span><span class="pun">./</span></code></li></ol></pre><p data-anchor-id="q03m">重启nginx服务器</p><blockquote data-anchor-id="t36i" class="white-blockquote">
  <p>service nginx restart</p>
</blockquote><p data-anchor-id="4rso">到目前为止nginx已经配置完毕，关于如何设置域名解析和虚拟主机，我改天再写篇文章。</p><div class="md-section-divider"></div><h4 data-anchor-id="e0sj" id="安装php">安装PHP</h4><ol data-anchor-id="6nc3">
<li>我们可以先查看一下阿里云仓库中保存的默认安装的PHP的 版本 <br>


<blockquote class="white-blockquote">
   apt-cache show php <br>
  可以看到，ubuntu16.04的系统默认安装的是PHP7.0</blockquote></li>
  <li>安装php <br>
   apt-get install php</li>
  </ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="u5gq"><ol class="linenums"><li class="L0"><code><span class="pun">这条命令会一次性安装以下包</span></code></li><li class="L1"><code><span class="pln">php</span><span class="pun">-</span><span class="pln">common php7</span><span class="pun">.</span><span class="lit">0</span><span class="pln"> php7</span><span class="pun">.</span><span class="lit">0</span><span class="pun">-</span><span class="pln">cli php7</span><span class="pun">.</span><span class="lit">0</span><span class="pun">-</span><span class="pln">common php7</span><span class="pun">.</span><span class="lit">0</span><span class="pun">-</span><span class="pln">fpm php7</span><span class="pun">.</span><span class="lit">0</span><span class="pun">-</span><span class="pln">json   php7</span><span class="pun">.</span><span class="lit">0</span><span class="pun">-</span><span class="pln">opcache php7</span><span class="pun">.</span><span class="lit">0</span><span class="pun">-</span><span class="pln">readline</span></code></li></ol></pre><ol data-anchor-id="g5n9">
<li>安装mysql(需要设置mysql的账号密码，账号默认为root) <br>


<blockquote class="white-blockquote">
  apt-cache search mysql //查看可安装的mysql包 <br>
  apt-get install mysql-server</blockquote></li>
  </ol><div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="xkst"><ol class="linenums"><li class="L0"><code><span class="pun">这条命令会一次性安装以下包</span></code></li><li class="L1"><code><span class="pln">libaio1 libcgi</span><span class="pun">-</span><span class="pln">fast</span><span class="pun">-</span><span class="pln">perl libcgi</span><span class="pun">-</span><span class="pln">pm</span><span class="pun">-</span><span class="pln">perl libencode</span><span class="pun">-</span><span class="pln">locale</span><span class="pun">-</span><span class="pln">perl</span></code></li><li class="L2"><code><span class="pln">  libevent</span><span class="pun">-</span><span class="pln">core</span><span class="pun">-</span><span class="lit">2.0</span><span class="pun">-</span><span class="lit">5</span><span class="pln"> libfcgi</span><span class="pun">-</span><span class="pln">perl libhtml</span><span class="pun">-</span><span class="pln">parser</span><span class="pun">-</span><span class="pln">perl libhtml</span><span class="pun">-</span><span class="pln">tagset</span><span class="pun">-</span><span class="pln">perl</span></code></li><li class="L3"><code><span class="pln">  libhtml</span><span class="pun">-</span><span class="kwd">template</span><span class="pun">-</span><span class="pln">perl libhttp</span><span class="pun">-</span><span class="pln">date</span><span class="pun">-</span><span class="pln">perl libhttp</span><span class="pun">-</span><span class="pln">message</span><span class="pun">-</span><span class="pln">perl libio</span><span class="pun">-</span><span class="pln">html</span><span class="pun">-</span><span class="pln">perl</span></code></li><li class="L4"><code><span class="pln">  liblwp</span><span class="pun">-</span><span class="pln">mediatypes</span><span class="pun">-</span><span class="pln">perl libtimedate</span><span class="pun">-</span><span class="pln">perl liburi</span><span class="pun">-</span><span class="pln">perl mysql</span><span class="pun">-</span><span class="pln">client</span><span class="pun">-</span><span class="lit">5.7</span></code></li><li class="L5"><code><span class="pln">  mysql</span><span class="pun">-</span><span class="pln">client</span><span class="pun">-</span><span class="pln">core</span><span class="pun">-</span><span class="lit">5.7</span><span class="pln"> mysql</span><span class="pun">-</span><span class="pln">common mysql</span><span class="pun">-</span><span class="pln">server</span><span class="pun">-</span><span class="lit">5.7</span><span class="pln"> mysql</span><span class="pun">-</span><span class="pln">server</span><span class="pun">-</span><span class="pln">core</span><span class="pun">-</span><span class="lit">5.7</span></code></li></ol></pre><blockquote data-anchor-id="347i" class="white-blockquote">
  <p>除了以上需要安装的软件，我们还需要以下一些软件</p>
</blockquote><ol data-anchor-id="o0ep">
<li><p>curl  信息采集和抓取使用</p>

<blockquote class="white-blockquote">
  <p>apt-get install curl</p>
</blockquote></li>
<li><p>git   版本管理工具</p>

<blockquote class="white-blockquote">
  <p>apt-get install git</p>
</blockquote></li>
<li><p>zip unzip 压缩、解压缩软件</p>

<blockquote class="white-blockquote">
  <p>apt-get install zip unzip</p>
</blockquote></li>
<li><p>redis 非关系型数据库(php的redis扩展不需要安装，因为laravel项目自带)</p>

<blockquote class="white-blockquote">
  <p>apt-get install redis-server</p>
</blockquote></li>
<li><p>php的curl扩展</p>

<blockquote class="white-blockquote">
  <p>apt-get install php-curl</p>
</blockquote></li>
<li><p>php的mysql扩展</p>

<blockquote class="white-blockquote">
  <p>apt-get install php7.0-mysql</p>
</blockquote></li>
<li><p>安装openssl</p>

<blockquote class="white-blockquote">
  <p>apt-get install openssl</p>
</blockquote></li>
<li><p>php的mbstring扩展</p>

<blockquote class="white-blockquote">
  <p>apt-get install php-mbstring</p>
</blockquote></li>
<li><p>php的xml扩展</p>

<blockquote class="white-blockquote">
  <p>apt-get install php-xml</p>
</blockquote></li>
<li><p>composer安装</p>

<blockquote class="white-blockquote">
  <p>先下载composer <br>
  wget <a href="https://getcomposer.org/download/1.4.1/composer.phar" target="_blank">https://getcomposer.org/download/1.4.1/composer.phar</a> <br>
   mv composer.phar /bin/composer <br>
   修改执行权限  chmod -R 777 composer <br>
   修改中国镜像源  composer config -g repo.packagist composer <a href="https://packagist.phpcomposer.com" target="_blank">https://packagist.phpcomposer.com</a> <br>
  这样就可全局执行了</p>
</blockquote></li>
</ol><div class="md-section-divider"></div><h3 data-anchor-id="oqoz" id="连接阿里云">连接阿里云</h3><p data-anchor-id="ogpv">连接阿里云有很多方法，对window系统，我们可以下载putty和xshell和fileZilla这三款软件中的任意一种</p><div class="md-section-divider"></div><h4 data-anchor-id="ihq5" id="1putty连接">1.putty连接</h4><ol data-anchor-id="ha86">
<li>百度搜putty下载并安装。</li>
<li>输入你要连接的服务器的IP、你阿里云的账号（一般为root）和当时设置的密码，如图 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170331/173254056.png" alt="mark" title=""> <br>
输入账号密码，如果看到如下界面，表示连接成功 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170331/173459530.png" alt="mark" title=""></li>
<li>连接成功后，就可以对服务器使用命令做各种操作了。</li>
</ol><div class="md-section-divider"></div><h4 data-anchor-id="bo63" id="2xshell连接">2.xshell连接</h4><ol data-anchor-id="nrxv">
<li>百度搜xshell下载并安装</li>
<li>点击文件》新建，新建一个到服务器的链接 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170331/173703169.png" alt="mark" title=""></li>
<li>输入账号密码登录 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170331/173839314.png" alt="mark" title=""></li>
</ol><div class="md-section-divider"></div><h3 data-anchor-id="y0ac" id="3filezilla这款软件主要做文件上传操作就是将你本地做得项目传到服务器上">3.fileZilla这款软件主要做文件上传操作，就是将你本地做得项目传到服务器上</h3><ol data-anchor-id="sufg">
<li>下载安装</li>
<li><p>点文件》新站点管理器，填如下设置，点击连接按钮连接服务器 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170331/174108421.png" alt="mark" title=""></p></li>
<li><p>进入主界面，左边是你本地的目录结构，右边是服务器的目录结构，选中左边要上传的项目拖动右边即可将文件上传 <br>
<img src="http://on64ewxzt.bkt.clouddn.com/blog/20170331/174654266.png" alt="mark" title=""></p></li>
</ol><div class="md-section-divider"></div><h3 data-anchor-id="wykg" id="有问题反馈">有问题反馈</h3><p data-anchor-id="h2ld">在使用中有任何问题，欢迎反馈给我，可以用以下联系方式跟我交流</p><ul data-anchor-id="6hw9">
<li>邮件(jiaohuafeng#gmail.com, 把#换成@)</li>
<li>QQ: 414582343</li>
<li>weibo: <a href="http://weibo.com/u/1650557301" target="_blank">@小华仔</a></li>
</ul></div>
</body>
</html>